System:
Solve the following coding problem. Wrap your code answer using ```


Question:
Write a COBOL program that processes a list of employee records from a flat file, calculates the total payroll (sum of salaries), and generates a report sorted by department.


Answer:
```
IDENTIFICATION DIVISION.
PROGRAM-ID. EMPLOYEE-REPORT.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  EMPLOYEE-RECORD.
    05  EMPLOYEE-ID           PIC X(10).
    05  EMPLOYEE-NAME         PIC X(20).
    05  EMPLOYEE-DEPARTMENT   PIC X(20).
    05  EMPLOYEE-SALARY       PIC 9(9)V99.
01  EMPLOYEE-LIST.
    05  EMPLOYEE-RECORD OCCURS 100.
01  TOTAL-PAYROLL           PIC 9(9)V99.
01  REPORT-LINE             PIC X(80).

PROCEDURE DIVISION.

MAIN-PROCEDURE.
    OPEN INPUT EMPLOYEE-FILE.
    PERFORM READ-RECORD UNTIL END-OF-FILE.
    PERFORM CALCULATE-PAYROLL.
    PERFORM GENERATE-REPORT.
    CLOSE EMPLOYEE-FILE.
    STOP RUN.

READ-RECORD.
    READ EMPLOYEE-FILE AT END
        DISPLAY "END OF FILE"
        EXIT PROGRAM.
    MOVE EMPLOYEE-RECORD TO EMPLOYEE-LIST (EMPLOYEE-RECORD).

CALCULATE-PAYROLL.
    MOVE ZERO TO TOTAL-PAYROLL.
    PERFORM VARYING EMPLOYEE-RECORD FROM 1 BY 1
        UNTIL EMPLOYEE-RECORD > 100
        ADD EMPLOYEE-SALARY OF EMPLOYEE-LIST (EMPLOYEE-RECORD)
            TO TOTAL-PAYROLL.

GENERATE-REPORT.
    SORT EMPLOYEE-LIST BY EMPLOYEE-DEPARTMENT.
    PERFORM VARYING EMPLOYEE-RECORD FROM 1 BY 1
        UNTIL EMPLOYEE-RECORD > 100
        MOVE SPACES TO REPORT-LINE.
        MOVE EMPLOYEE-DEPARTMENT OF EMPLOYEE-LIST (EMPLOYEE-RECORD)
            TO REPORT-LINE (1:20).
        MOVE TOTAL-PAYROLL TO REPORT-LINE (21:30).
        DISPLAY REPORT-LINE.
```
<|endoftext|>